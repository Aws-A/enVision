<meta http-equiv='cache-control' content='no-cache'> 
<meta http-equiv='expires' content='0'> 
<meta http-equiv='pragma' content='no-cache'>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!DOCTYPE html>
<html>
<head>
<title> enVisionMagazine </title>
<link href="css/styleVD.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="js/indexVD.js"></script>
</head>
    <body>
        <header>
            <div class="top">
                <div class="logo">
                    <img src="images/enVisionO.png">
                </div>
                <img src="images/menu.png" id="menu-icon" alt="Menu">
                <nav>
                    <a href="enVisionDocumentaries.html"> Home </a>
                    <a href="about.html"> About </a>
                    <a href="#contact"> Contact </a>
                </nav>
                <form action="search.html" method="get">
                    <button type="submit" class="searchButton"> <img src="images/searchIcon.svg"></button>
                    <input type="text" name="query" placeholder="Search...">
                </form>
            </div>
        <!-- Hidden menu content -->
        <div id="mobile-menu">
            <a href="enVisionDocumentaries.html">Home</a>
            <a href="about.html">About</a>
            <a href="#contact">Contact</a>
        </div>
            <section class="video-sec">
                <div class="video-screen">
                    <div class="video-part">
                        <!-- Dynamic YouTube iframe -->
                    <iframe class="vid" 
                        id="previewVideo"
                        width="640" 
                        height="360" 
                        src="" 
                        title="Video Player" 
                        frameborder="0" 
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                        allowfullscreen>
                    </iframe>
                        <!-- Dynamic Title -->
                        <h1 class="title" id="videoTitleDisplay">
                            <!-- Title will be injected here -->
                        </h1>
                    </div>
                </div>

                <div class="video-info">
                    <div class="info-header">
                        <!-- Dynamic Topic / Category -->
                        <div class="category-box">
                            <h2 class="Category" id="videoTopicDisplay">
                                <!-- Topic will be injected here -->
                            </h2>
                        </div>
                        <!-- Views -->
                        <div class="views-number">
                            <h2 id="videoViews">
                                33,059
                            </h2>
                        </div>
                    </div>
                    <!-- Dynamic Description -->
                    <div class="info-description">
                        <h3 id="videoDescDisplay">
                            <!-- Description will be injected here -->
                        </h3>
                    </div>
                </div>
            </section>

        </header>
            <section id="interactives">
                <div id="interactives-icons">
                    <div class="icon-container">
                        <img src="images/like.png" class="icon" id="like">
                        <span id="like-count">0</span>
                    </div>
                    <div class="icon-container">
                        <img src="images/comment.png" class="icon" id="comment">
                        <span id="comment-count">0</span>
                    </div>
                    <div class="icon-container">
                        <img src="images/share.png" class="icon" id="share">
                        <span id="share-count">0</span>
                    </div>
                </div>
                <!-- Comments section -->
                <div id="comment-section" style="display: none; margin-top: 15px;">
                    <textarea id="comment-input" rows="3" placeholder="Write a comment..."></textarea>
                    <button id="submit-comment">Comment</button>
                </div>
                <!-- Where submitted comments will appear -->
                <div id="comments-list"></div>

                <!-- Delete Confirmation Overlay -->
                <div id="delete-confirm" class="delete-confirm hidden">
                    <p>Are you sure you want to delete this comment?</p>
                    <button id="confirm-delete">Confirm</button>
                    <button id="cancel-delete">Cancel</button>
                </div>

                <!-- Share Options -->
                <div id="share-options" class="share-options hidden">
                    <a href="mailto:?subject=Check this out!&body=I thought you‚Äôd find this interesting: https://yourwebsite.com" target="_blank">
                    <img src="images/email.png" alt="Email" class="icon email">
                    </a>
                    <a href="https://www.facebook.com/sharer/sharer.php?u=https://yourwebsite.com" target="_blank">
                    <img src="images/facebook.png" alt="Facebook" class="icon facebook">
                    </a>
                    <a href="https://twitter.com/intent/tweet?url=https://yourwebsite.com&text=Check this out!" target="_blank">
                    <img src="images/twitter.png" alt="Twitter" class="icon twitter">
                    </a>
                    <a href="https://wa.me/?text=Check this out! https://yourwebsite.com" target="_blank">
                    <img src="images/whatsapp.png" alt="WhatsApp" class="icon whatsapp">
                    </a>
                    <a href="https://t.me/share/url?url=https://yourwebsite.com&text=Check this out!" target="_blank">
                    <img src="images/telegram.png" alt="Telegram" class="icon telegram">
                    </a>
                    <a href="https://www.instagram.com/" target="_blank">
                    <img src="images/instagram.png" alt="Instagram" class="icon instagram">
                    </a>
                    <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://yourwebsite.com" target="_blank">
                    <img src="images/linkedIn.png" alt="LinkedIn" class="icon linkedin">
                    </a>
                </div>
            </section>
        <section class="vids">
            <h4 class="others-title"> Other Videos </h4>
            <div class="otherVids">
                <img src="images/views1.png" class="others"/>
                <img src="images/views2.png" class="others"/>
                <img src="images/views3.png" class="others"/>
                <img src="images/rates1.png" class="others"/>
                <img src="images/rates2.png" class="others"/>
                <img src="images/rates3.png" class="others"/>
            </div>
        </section>
<!-- Footer -->

<footer id="contact" class="vid-footer">
<p> Copyright innovi 2022 - 2025 </p>
<div class="socials">
    <img src="images/facebookHover.png" class="facebookIcon">
    <img src="images/x.png" class="xIcon">
    <img src="images/youtube.png" class="youtubeIcon">
</div>
<p> info.envision@innovi.com </p>
</footer>

<!-- Footer -->

<script type="module">

import { initializeApp, getApps, getApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getFirestore, collection, getDocs, doc, getDoc, query, limit } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";
    window.addEventListener("DOMContentLoaded", async () => {

// Firebase config
const firebaseConfig = {
  apiKey: "AIzaSyB_aEQJrZILdy2JYl6HbLwT43myJhVJH6g",
  authDomain: "envision-ed5f3.firebaseapp.com",
  projectId: "envision-ed5f3",
  storageBucket: "envision-ed5f3.appspot.com",
  messagingSenderId: "202691344541",
  appId: "1:202691344541:web:2f6c93e7f5138adf127c74",
  measurementId: "G-3NB50YD8F0"
};

const app = getApps().length ? getApp() : initializeApp(firebaseConfig);
const db = getFirestore(app);

// DOM elements
const videoTitleDisplay = document.getElementById("videoTitleDisplay");
const videoDescDisplay = document.getElementById("videoDescDisplay");
const videoTopicDisplay = document.getElementById("videoTopicDisplay");
const iframeVideo = document.getElementById("previewVideo");

// Convert YouTube URL to embed URL
function toEmbedURL(url) {
    if (!url) return "";
    let videoId = "";
    try {
        // Short URL youtu.be
        if (url.includes("youtu.be/")) {
            videoId = url.split("youtu.be/")[1].split(/[?&]/)[0];
        }
        // Standard YouTube URL
        else if (url.includes("youtube.com/watch")) {
            const params = new URL(url).searchParams;
            videoId = params.get("v");
        }
        else {
            return url; // Already embed or unknown
        }
        if (!videoId) return ""; // safety
        return `https://www.youtube.com/embed/${videoId}`;
    } catch (e) {
        console.error("Invalid YouTube URL", url);
        return "";
    }
}

// Load video by ID
async function loadVideoById(id) {
  const videoDocRef = doc(db, "science&nature-videos", id);
  const docSnap = await getDoc(videoDocRef);
  if (docSnap.exists()) {
    const data = docSnap.data();
    videoTitleDisplay.textContent = data.title;
    videoDescDisplay.innerHTML = data.description.replace(/\n/g, "<br>");
    videoTopicDisplay.textContent = data.topic;

    if (data.videoUrl) {
      // üîπ Use toEmbedURL here!
      iframeVideo.src = toEmbedURL(data.videoUrl);
    }
  } else {
    console.error("‚ùå No video found with ID:", id);
  }
}

// Load first video in the collection
async function loadFirstVideo() {
  const videosCol = collection(db, "science&nature-videos");
  const q = query(videosCol, limit(1));
  const snapshot = await getDocs(q);
  if (!snapshot.empty) {
    const firstDoc = snapshot.docs[0];
    await loadVideoById(firstDoc.id);
  } else {
    console.error("‚ùå No videos found in collection");
  }
}

// Main
loadFirstVideo();
});

</script>

	</body>
</html>