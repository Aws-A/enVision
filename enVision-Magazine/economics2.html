<meta http-equiv='cache-control' content='no-cache'> 
<meta http-equiv='expires' content='0'> 
<meta http-equiv='pragma' content='no-cache'>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!DOCTYPE html>
<html>
<head>
<title> enVisionMagazine </title>
<link href="css/styleVM.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="js/indexVM.js"></script>
</head>
    <body>
        <header>
             <div class="logo">
                <img src="images/enVisionG.png">
            </div>
            <img src="images/menu.png" id="menu-icon" alt="Menu">
            <nav>
                <a href="enVisionMagazine.html"> Home </a>
                <a href="about.html"> About </a>
                <a href="#contact"> Contact </a>
            </nav>
            <form action="search.html" method="get">
                <button type="submit" class="searchButton"> <img src="images/searchIcon.svg"></button>
                <input type="text" name="query" placeholder="Search...">
            </form>
       </header>

<!-- Hidden menu content -->
<div id="mobile-menu">
    <a href="enVisionMagazine.html">Home</a>
    <a href="about.html">About</a>
    <a href="#contact">Contact</a>
</div>

<h2> Digital Magazine for diverse topics </h2>
<section class="allContent">
    <div class="list">
        <h4> Humanities </h4>
            <a href="spirituality&philosophy.html"><h5> Spirituality & Philosophy </h5></a>
            <a href="languages.html"><h5> Languages </h5></a>
            <a href="history.html"><h5> History </h5></a>
            <a href="geography.html"><h5> Geography </h5></a>
            <a href="politics.html"><h5> Politics </h5></a>
            <a href="arts.html"><h5> Arts </h5></a>
        <h4> Science </h4>
            <a href="biology.html"><h5> Biology </h5></a>
            <a href="health.html"><h5> Health </h5></a>
            <a href="chemistry.html"><h5> Chemistry </h5></a>
            <a href="mathematics.html"><h5> Mathematics </h5></a>
            <a href="physics.html"><h5> Physics </h5></a>
            <a href="astronomy.html"><h5> Astronomy </h5></a>
            <a href="technology.html"><h5> Technology </h5></a>
            <a href="social.html"><h5> Social Sciences </h5></a>
            <a href="economics.html" class="active-page"><h5> Economics </h5></a>
        <h4> Others </h4>
            <a href="sports.html"><h5> Sports </h5></a>
            <a href="hobbies.html"><h5> Hobbies </h5></a>
            <a href="travel.html"><h5> Travel </h5></a>
            <a href="food.html"><h5> Food </h5></a>
    </div>

    <div class="articles">
        <h1> Economics Articles </h1>
         <div id="loaded-articles">
            <!-- Articles from Firebase will be loaded here dynamically -->
        </div>
<!-- Pagination -->
        <div id="pagination" style="display: flex; align-items: center; gap: 10px;">
            <button id="prevPage" style="background: none; border: none; cursor: pointer;">
                <img id="prevImg" src="images/previous.png" alt="Previous" style="width: 30px; height: 30px;">
            </button>
            <!-- Page number in a circle -->
            <div id="pageNumber" >
                1
            </div>
            <!-- Next button as image -->
            <button id="nextPage" class="nextPageLast" style="background: none; border: none; cursor: pointer;">
                <img id="nextImg" src="images/next.png" alt="Next" style="width: 30px; height: 30px;">
            </button>
        </div>
    </div>

    <div class="stories">
        <h1 class="storiesTitle"> Top Stories</h1>
        <a href="enVisionMagazine-l3.html" onclick="localStorage.setItem('activeStory', 'charles-dickens');" style="text-decoration: none; color: inherit;">
            <div class="str strTop" data-id="charles-dickens">
                <h3> Charles Dickens </h3>
                <p> 
                    Charles Dickens (1812-1870) was a renowned English novelist and social critic, widely regarded as one of the greatest writers of the Victorian era. 
                </p> 
            </div>
        </a>
        <a href="enVisionMagazine-py3.html" onclick="localStorage.setItem('activeStory', 'light-speed');" style="text-decoration: none; color: inherit;">
            <div class="str strR" data-id="light-speed">
                <h3> Light Speed </h3>
                <p> 
                    Light travels through space at a constant speed of approximately 186,282 miles per second (299,792 kilometers per second) in a vacuum.
                </p>  
            </div>
        </a>
        <a href="enVisionMagazine-b3.html" onclick="localStorage.setItem('activeStory', 'bees-life');" style="text-decoration: none; color: inherit;">
            <div class="str strR" data-id="bees-life"> 
                <h3> Bees Life </h3>
                <p> 
                    Bees are fascinating insects with complex and highly organized social lives. 
                </p> 
            </div>
        </a>
    </div>
    
</section>
<!-- Footer -->

<footer>
<p> Copyright innovi 2022 -2024 </p>
<div class="socials">
    <img src="images/facebookHover.png" >
    <img src="images/x.png" >
    <img src="images/youtube.png" >
</div>
<p> info.-envision@innovi.com </p>
</footer>

<!-- Footer -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getFirestore, collection, getDocs, query, orderBy, limit } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

// --- Firebase config ---
const firebaseConfig = {
  apiKey: "AIzaSyB_aEQJrZILdy2JYl6HbLwT43myJhVJH6g",
  authDomain: "envision-ed5f3.firebaseapp.com",
  projectId: "envision-ed5f3",
  storageBucket: "envision-ed5f3.appspot.com",
  messagingSenderId: "202691344541",
  appId: "1:202691344541:web:2f6c93e7f5138adf127c74",
  measurementId: "G-3NB50YD8F0"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

// --- DOM elements ---
const articlesContainer = document.getElementById("loaded-articles");
const prevBtn = document.getElementById("prevPage");
const nextBtn = document.getElementById("nextPage");
const pageNumberDiv = document.getElementById("pageNumber");

// reference to your static articles on page 1
const staticArticles = Array.from(document.querySelectorAll(".articles .arti"));

let currentPage = 2;
const pageSize = 5;

async function loadArticles() {
  try {
    // Adjust 'createdAt' field if your documents donâ€™t have it
    const q = query(
      collection(db, "economics-articles"),
      orderBy("createdAt", "desc"), 
      limit(pageSize)
    );

    const snapshot = await getDocs(q);

    if (snapshot.empty) {
      articlesContainer.innerHTML = "<p>No articles found.</p>";
      return;
    }

    articlesContainer.innerHTML = "";

snapshot.forEach(doc => {
  const article = doc.data();

  const artiDiv = document.createElement("div");
  artiDiv.className = "arti";

// Tag
const tagDiv = document.createElement("div");
tagDiv.className = "tag";
tagDiv.textContent = doc.data().topic; // ðŸ‘ˆ show the topic from Firebase
artiDiv.appendChild(tagDiv);

// Image (with fallback)
const img = document.createElement("img");
img.src = article.imageUrl || "images/magazine.png";
img.onerror = () => { img.src = "images/magazine.png"; };
artiDiv.appendChild(img);

// Apply margin after image loads
img.addEventListener("load", () => {
  const width = img.naturalWidth;
  const height = img.naturalHeight;

  if (height > width) {
    img.style.marginTop = "-25%";
  } else if (width > height) {
    img.style.marginTop = "-10%";
  } else {
    img.style.marginTop = "-15%";
  }
});


  // Title
  const h3 = document.createElement("h3");
  h3.textContent = article.title || "No Title";
  artiDiv.appendChild(h3);

  // Body (first 15 words)
  const p = document.createElement("p");
  const words = (article.body || '').split(' ').slice(0, 15).join(' ');
  const collectionName = "economics-articles"; // same collection you queried
  p.innerHTML = `${words}${(article.body && article.body.split(' ').length > 15 ? '...' : '')} <br>
  <a href="enVisionMagazine-article.html?id=${doc.id}&collection=${encodeURIComponent(collectionName)}">See More</a>`;
  artiDiv.appendChild(p);

  // Append article to container
  articlesContainer.appendChild(artiDiv);
});


  } catch (err) {
    console.error("Error loading articles:", err);
    articlesContainer.innerHTML = "<p>Error loading articles.</p>";
  }
}

// --- Load articles immediately on page load ---
loadArticles();

// --- Pagination circle ---
function createPages() {
  pageNumberDiv.innerHTML = "";

  for (let i = 1; i <= 2; i++) {
    const page = document.createElement("div");
    page.textContent = i;

    // Make the clicked page green
    page.style.cssText = `
        width: 30px; height: 30px;
        border-radius: 50%;
        display: flex; align-items: center; justify-content: center;
        font-weight: bold; cursor: pointer;
        margin: 0 5px;
        background-color: ${i === currentPage ? "#35B851" : "rgba(248,248,248,0.75)"};
        color: ${i === currentPage ? "white" : "black"};
    `;

    page.addEventListener("click", async () => {
      currentPage = i;
      createPages(); // refresh highlight

      if (currentPage === 1) {
        // Navigate to economics1.html
        window.location.href = "economics.html";
      } else if (currentPage === 2) {
        staticArticles.forEach(div => div.style.display = "none");
        await loadArticles(); // load Firebase articles dynamically
      }
    });

    pageNumberDiv.appendChild(page);
  }
}

// --- Next/Prev buttons ---
nextBtn.addEventListener("click", async () => {
  if (currentPage === 1) {
    currentPage = 2;
    staticArticles.forEach(div => div.style.display = "none");
    await loadArticles();
    createPages();
  }
});

prevBtn.addEventListener("click", () => {
  if (currentPage === 2) {
    currentPage = 1;
    staticArticles.forEach(div => div.style.display = "block");
    articlesContainer.innerHTML = "";
    createPages();
  }
});

// --- Arrow hover ---
const prevImg = document.getElementById("prevImg");
prevImg.addEventListener("mouseenter", () => prevImg.src = "images/previousHover.png");
prevImg.addEventListener("mouseleave", () => prevImg.src = "images/previous.png");

const nextImg = document.getElementById("nextImg");
nextImg.addEventListener("mouseenter", () => nextImg.src = "images/nextHover.png");
nextImg.addEventListener("mouseleave", () => nextImg.src = "images/next.png");

// Navigate to economics.html on click
prevImg.addEventListener("click", () => {
    window.location.href = "economics.html";
});


// --- Initialize ---
createPages();
</script>
	</body>
</html>
